<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>eProstutiBD প্রশ্নব্যাংক — সকল প্রস্তুতি হোক গভীর থেকে</title>

  <meta name="description" content="eProstutiBD প্রশ্নব্যাংক — বিষয়ভিত্তিক MCQ, Written এবং Subject Model Test। সকল প্রস্তুতি হোক গভীর থেকে।" />
  <meta name="keywords" content="প্রশ্নব্যাংক, MCQ, Written, Model Test, eProstutiBD, Admission, BCS, IELTS" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#1d4ed8" />

  <style>
    :root{
      --bg1:#f6f8ff; --bg2:#eef6ff;
      --line: rgba(18, 28, 55, .10);
      --text:#0f1730; --muted:#5a6685;

      --shadow: 0 16px 44px rgba(15,23,48,.12);
      --shadow2: 0 10px 26px rgba(15,23,48,.08);

      --footerA:#0b1b45;
      --footerB:#071635;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans Bengali", sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 10% 10%, rgba(29,78,216,.12), transparent 55%),
        radial-gradient(800px 560px at 92% 14%, rgba(14,165,233,.10), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    a{color:inherit}

    /* ✅ Desktop side gap = ~1/2 inch (48px). Mobile = 12px */
    .container{
      max-width: 1320px;
      margin: 0 auto;
      padding-left: clamp(12px, 4vw, 48px);
      padding-right: clamp(12px, 4vw, 48px);
      padding-top: 10px;
      padding-bottom: 10px;
    }

    /* ===== Header ===== */
    header{
      position:sticky; top:0; z-index:50;
      background: linear-gradient(135deg, rgba(29,78,216,.96), rgba(14,165,233,.92));
      border-bottom: 1px solid rgba(255,255,255,.22);
      box-shadow: 0 14px 34px rgba(29,78,216,.18);
    }
    .topbar{
      max-width: 1320px;
      margin:0 auto;
      padding-left: clamp(12px, 4vw, 48px);
      padding-right: clamp(12px, 4vw, 48px);
      padding-top: 10px;
      padding-bottom: 10px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:3px;
      flex:0 0 auto;
      min-width:0;
    }
    .brand .name{
      color:#fff;
      font-weight:1000;
      letter-spacing:.2px;
      font-size:15px;
      line-height:1;
      white-space:nowrap;
    }
    .brand .tag{
      color:rgba(255,255,255,.88);
      font-size:12px;
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 260px;
    }

    .nav{
      display:flex;
      gap:8px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width:none;
      padding-bottom: 2px;
      flex:1;
    }
    .nav::-webkit-scrollbar{display:none}
    .nav a{
      flex:0 0 auto;
      text-decoration:none;
      color:#fff;
      font-size:12px;
      font-weight:1000;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      white-space:nowrap;
      transition:.15s;
    }
    .nav a:hover{background: rgba(255,255,255,.16)}
    .nav a.active{background: rgba(255,255,255,.22); border-color: rgba(255,255,255,.26)}

    /* ✅ mobile menu button right side */
    .menuBtn{
      flex:0 0 auto;
      margin-left:auto;
      display:none;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.14);
      color:#fff;
      border-radius: 12px;
      padding: 8px 10px;
      font-weight:1000;
      font-size:12px;
      cursor:pointer;
      line-height:1;
    }

    @media (max-width: 860px){
      .nav{display:none;}
      .menuBtn{display:inline-flex;align-items:center;gap:8px;}
      .brand .tag{max-width: 55vw;}
    }

    /* ===== Mobile Menu (No background panel, outside click hide) ===== */
    .mobileMenu{
      display:none;
      position: fixed;
      inset: 0;
      z-index: 9999;
    }
    .mobileMenu .overlay{
      position:absolute;
      inset:0;
      background: transparent; /* ✅ no overlay color */
    }
    .mobileMenu .drawer{
  position:absolute;
  top: 64px;
  right: 12px;
  width: min(320px, calc(100vw - 24px));
  border-radius: 16px;
  padding: 10px;

  border: 1px solid rgba(255,255,255,.28);

  /* ✅ readable background */
  background: rgba(8, 20, 55, .78);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  box-shadow: 0 18px 38px rgba(0,0,0,.35);
}

.mobileMenu a{
  display:block;
  text-decoration:none;
  color:#ffffff;                 /* ✅ bright text */
  font-weight:1000;
  font-size:13px;                /* ✅ slightly bigger */
  padding: 12px 12px;
  border-radius: 12px;

  border: 1px solid rgba(255,255,255,.16);

  /* ✅ subtle item background to separate rows */
  background: rgba(255,255,255,.06);

  margin-bottom: 8px;
  white-space:nowrap;
}

.mobileMenu a.active{
  border-color: rgba(255,255,255,.28);
  background: rgba(255,255,255,.12);
}
    /* ===== Notice + Header Ad ===== */
    .noticeBar{
      margin-top: 10px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.72);
      border-radius: 16px;
      overflow:hidden;
      box-shadow: var(--shadow2);
    }
    .noticeRow{display:flex;align-items:center;gap:10px;padding: 10px 12px;}
    .noticeTag{
      flex:0 0 auto;
      font-size:12px;
      font-weight:1000;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(29,78,216,.10);
      border: 1px solid rgba(29,78,216,.18);
      color: var(--text);
      white-space:nowrap;
    }
    .marq{flex:1;overflow:hidden;white-space:nowrap;color: var(--muted);font-size:12px;}
    .marq span{display:inline-block;padding-left: 100%;animation: ticker 18s linear infinite;}
    @keyframes ticker{0%{transform: translateX(0)}100%{transform: translateX(-100%)}}

    .adBox{
      margin-top: 10px;
      border: 1px dashed rgba(18,28,55,.22);
      border-radius: 16px;
      background: rgba(255,255,255,.72);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .adHead{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(18,28,55,.10);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      font-size:12px;
      color: var(--muted);
    }
    .adHead b{color: var(--text)}
    .adBody{min-height: 110px;display:grid;place-items:center;padding: 10px;text-align:center;color: var(--muted);}

    /* ===== Main layout ===== */
    .grid{
      display:grid;
      grid-template-columns: 1fr 300px;
      gap: 10px;
      align-items:start;
      margin-top: 12px;
    }
    @media (max-width: 980px){ .grid{grid-template-columns: 1fr;} }

    .panel{
      border: 1px solid var(--line);
      border-radius: 20px;
      background: rgba(255,255,255,.70);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panelHead{
      padding: 12px 14px;
      border-bottom: 1px solid rgba(18,28,55,.10);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .panelHead b{font-size:14px}
    .panelHead .muted{font-size:12px;color:var(--muted)}
    .panelBody{padding: 12px 14px}

    .searchRow{display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap;}
    .searchMini{display:flex;gap:8px;align-items:center;flex-wrap:nowrap;}
    .searchMini input{
      width: 190px;                 /* ✅ smaller */
      max-width: 70vw;
      border:1px solid rgba(18,28,55,.12);
      background: rgba(255,255,255,.86);
      color: var(--text);
      padding: 9px 10px;
      border-radius: 14px;
      outline:none;
      box-shadow: 0 10px 22px rgba(15,23,48,.05);
      font-size: 13px;
    }
    @media (max-width: 560px){
      .searchMini{width:100%;}
      .searchMini input{width:100%;}
    }
    .btn{
      border:1px solid rgba(18,28,55,.12);
      background: rgba(255,255,255,.86);
      color: var(--text);
      border-radius: 14px;
      padding: 8px 10px;
      height: 36px;
      font-size:12px;
      font-weight:1000;
      cursor:pointer;
      white-space:nowrap;
      box-shadow: 0 10px 22px rgba(15,23,48,.05);
      transition:.15s;
    }
    .btn.primary{border-color: rgba(29,78,216,.22);background: rgba(29,78,216,.10);}
    .divider{height:1px;background: rgba(18,28,55,.10);margin: 12px 0;}

    .subjects{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}
@media (max-width: 1100px){
  .subjects{ grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 560px){
  .subjects{ grid-template-columns: 1fr; }
}

    .subCard{
      border: 1px solid rgba(18,28,55,.10);
      background: rgba(255,255,255,.92);
      border-radius: 18px;
      padding: 12px;
      cursor:pointer;
      transition:.15s;
      box-shadow: 0 12px 26px rgba(15,23,48,.06);
      position:relative;
      overflow:hidden;
    }
    .subCard::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(560px 140px at 20% 0%, rgba(29,78,216,.10), transparent 55%),
        radial-gradient(560px 140px at 100% 0%, rgba(14,165,233,.10), transparent 55%);
      opacity:.9;
      pointer-events:none;
    }
    .subCard h3{
      position:relative;margin:0;font-size:14px;font-weight:1000;line-height: 1.2;
      display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height: 34px;
    }

    /* ✅ One-line counts */
    .counts{
      position:relative;
      margin-top: 8px;
      display:flex;
      gap:8px;
      flex-wrap: nowrap;     /* one line */
      align-items:center;
      overflow:hidden;
    }
    .countPill{
      font-size:12px;
      padding: 6px 9px;
      border-radius:999px;
      border: 1px solid rgba(18,28,55,.12);
      background: rgba(255,255,255,.78);
      color: var(--muted);
      white-space: nowrap;
    }
    .countPill b{color: var(--text)}

    .inlineAd{
      border: 1px dashed rgba(18,28,55,.22);
      background: rgba(255,255,255,.78);
      border-radius: 18px;
      padding: 12px;
      min-height: 90px;
      display:grid;
      place-items:center;
      text-align:center;
      color: var(--muted);
      box-shadow: 0 10px 22px rgba(15,23,48,.04);
    }
    .inlineAd .tag{
      display:inline-block;font-weight:1000;color: var(--text);
      padding: 6px 10px;border-radius:999px;border:1px solid rgba(18,28,55,.12);
      background: rgba(255,255,255,.86);margin-bottom: 6px;font-size:12px;
    }
    .empty{
      display:none;border:1px dashed rgba(18,28,55,.22);
      background: rgba(255,255,255,.70);
      border-radius: 16px;
      padding: 12px;
      color: var(--muted);
      margin-top: 12px;
      font-size:12px;
    }

    .mtSection{margin-top: 14px;border-top: 1px solid rgba(18,28,55,.10);padding-top: 12px;}
    .mtTitle{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom: 10px;}
    .mtTitle b{font-size:13px}

    /* ✅ Model tests: 3 per row on desktop */
    .mtGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }
    @media (max-width: 900px){ .mtGrid{ grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 560px){ .mtGrid{ grid-template-columns: 1fr; } }

    .mtCard{
      border: 1px solid rgba(18,28,55,.10);
      background: rgba(255,255,255,.92);
      border-radius: 16px;
      padding: 12px;
      cursor:pointer;
      transition:.15s;
      box-shadow: 0 10px 22px rgba(15,23,48,.05);
    }
    .mtCard h4{
      margin:0;font-size: 13px;line-height: 1.25;font-weight:1000;
      display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height: 34px;
    }
    .mtMeta{margin-top: 8px;display:flex;gap:8px;flex-wrap:wrap;color: var(--muted);font-size:12px;}
    .mtMeta span{border:1px solid rgba(18,28,55,.10);background: rgba(255,255,255,.78);border-radius: 999px;padding: 6px 10px;}

    .sidePanel{
      border: 1px solid var(--line);
      border-radius: 20px;
      background: rgba(255,255,255,.70);
      box-shadow: var(--shadow);
      overflow:hidden;
      height: fit-content;
      position: sticky;
      top: 72px;
    }
    @media (max-width: 980px){ .sidePanel{position: static; top:auto;} }
    .sidePanel .head{
      padding: 12px 14px;
      border-bottom: 1px solid rgba(18,28,55,.10);
      display:flex;align-items:center;justify-content:space-between;
      font-size:12px;color: var(--muted);
    }
    .sidePanel .head b{color:var(--text);font-size:13px}
    .sidePanel .body{padding: 12px}
    .sideAdBox{
      border: 1px dashed rgba(18,28,55,.22);
      background: rgba(255,255,255,.78);
      border-radius: 16px;
      min-height: 230px;
      display:grid;
      place-items:center;
      text-align:center;
      padding: 10px;
      box-shadow: 0 10px 22px rgba(15,23,48,.04);
      color: var(--muted);
    }

    /* ===== Footer ===== */
    footer{
      margin-top: 14px;
      border-top: 1px solid rgba(255,255,255,.18);
      background:
        radial-gradient(700px 240px at 20% 0%, rgba(96,165,250,.20), transparent 60%),
        radial-gradient(700px 240px at 80% 0%, rgba(34,197,94,.16), transparent 60%),
        linear-gradient(180deg, var(--footerA), var(--footerB));
      color: rgba(255,255,255,.92);
    }
    .foot{
      max-width: 1320px;
      margin:0 auto;
      padding-left: clamp(12px, 4vw, 48px);
      padding-right: clamp(12px, 4vw, 48px);
      padding-top: 16px;
      padding-bottom: 10px;
      display:grid;
      grid-template-columns: 1.1fr 1fr 1fr 1fr;
      gap: 14px;
      align-items:start;
    }

    /* ✅ Mobile footer: 2 columns */
    @media (max-width: 560px){
      .foot{
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      .footLogo{grid-column: 1 / -1;}
      .footFollow{grid-column: 1 / -1;}
    }

    .foot b{font-size:13px}
    .foot a{display:block;text-decoration:none;color: rgba(255,255,255,.78);font-size:12px;padding: 6px 0;}
    .foot a:hover{color:#fff}

    .footBrand{
      display:flex;
      flex-direction:column;
      gap:3px;
    }
    .footBrand .name{
      color:#fff;
      font-weight:1000;
      letter-spacing:.2px;
      font-size:15px;
      line-height:1;
      white-space:nowrap;
    }
    .footBrand .tag{
      color:rgba(255,255,255,.78);
      font-size:12px;
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 320px;
    }

    /* Social icons one-line, icon only, no box */
    .socialRow{
      display:flex;
      gap:14px;
      align-items:center;
      flex-wrap:nowrap;
      margin-top: 10px;
    }
    .socialRow a{
      display:inline-grid;
      place-items:center;
      text-decoration:none;
      opacity:.92;
      transition: opacity .15s, transform .15s;
    }
    .socialRow a:hover{opacity:1; transform: translateY(-1px);}
    .socialRow svg{width:20px;height:20px; fill: rgba(255,255,255,.92);}

    /* Mobile: hide social icons */
    @media (max-width: 560px){
      .socialRow{display:none;}
    }

    .copy{
      max-width: 1320px;
      margin:0 auto;
      padding-left: clamp(12px, 4vw, 48px);
      padding-right: clamp(12px, 4vw, 48px);
      padding-bottom: 14px;
      color: rgba(255,255,255,.72);
      font-size:12px;
      text-align:center;
      white-space:nowrap;
    }

    .skeleton{
      border: 1px solid rgba(18,28,55,.10);
      background: rgba(255,255,255,.78);
      border-radius: 18px;
      padding: 12px;
      min-height: 100px;
      position: relative;
      overflow:hidden;
      box-shadow: 0 10px 22px rgba(15,23,48,.04);
    }
    .shimmer{
      position:absolute; inset:0;
      background: linear-gradient(110deg, transparent 0%, rgba(0,0,0,.04) 20%, transparent 40%);
      transform: translateX(-100%);
      animation: sh 1.15s infinite;
    }
    @keyframes sh{to{transform: translateX(100%)}}
  </style>
</head>

<body>
  <header>
    <div class="topbar">
      <div class="brand">
        <div class="name">eProstutiBD</div>
        <div class="tag">সকল প্রস্তুতি হোক গভীর থেকে</div>
      </div>

      <nav class="nav" aria-label="Main navigation">
        <a class="active" href="#">একাডেমী</a>
        <a href="#">প্রশ্ন ব্যাঙ্ক</a>
        <a href="#">এডমিশন অ্যাসিস্ট্যান্ট</a>
        <a href="#">জব অ্যাসিস্ট্যান্ট</a>
        <a href="#">মডেল টেস্ট</a>
        <a href="#">কারেন্ট এফেয়ার্স</a>
        <a href="#">IELTS</a>
        <a href="#">BCS</a>
        <a href="#">নোটিশ</a>
        <a href="#">ব্লগ</a>
        <a href="#">ক্যারিয়ার</a>
      </nav>

      <button class="menuBtn" id="menuBtn" aria-expanded="false" aria-controls="mobileMenu" onclick="toggleMenu()">☰</button>
    </div>

    <!-- ✅ Mobile Menu -->
    <div class="mobileMenu" id="mobileMenu">
      <div class="overlay" onclick="closeMenu()"></div>
      <div class="drawer" role="dialog" aria-label="Menu" onclick="event.stopPropagation()">
        <a class="active" href="#">একাডেমী</a>
        <a href="#">প্রশ্ন ব্যাঙ্ক</a>
        <a href="#">এডমিশন অ্যাসিস্ট্যান্ট</a>
        <a href="#">জব অ্যাসিস্ট্যান্ট</a>
        <a href="#">মডেল টেস্ট</a>
        <a href="#">কারেন্ট এফেয়ার্স</a>
        <a href="#">IELTS</a>
        <a href="#">BCS</a>
        <a href="#">নোটিশ</a>
        <a href="#">ব্লগ</a>
        <a href="#">ক্যারিয়ার</a>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="noticeBar" role="region" aria-label="Notice">
      <div class="noticeRow">
        <span class="noticeTag">নোটিশ</span>
        <div class="marq">
          <span>আজকের আপডেট: নতুন Subject যুক্ত হয়েছে • নতুন Model Test যুক্ত হয়েছে • নিয়মিত পড়াশোনা করুন • সকল প্রস্তুতি হোক গভীর থেকে</span>
        </div>
      </div>
    </div>

    <div class="adBox">
      <div class="adHead">
        <b>Ad Slot</b>
        <span>Header নিচে • Responsive</span>
      </div>
      <div class="adBody">
        <div>
          <div style="font-weight:1000;color:var(--text);margin-bottom:6px;">Responsive Ad</div>
          <div style="font-size:12px;color:var(--muted)">Paste ad code here</div>
        </div>
      </div>
    </div>

    <main class="grid">
      <section class="panel">
        <div class="panelHead">
          <b>Subjects</b>
          <span class="muted" id="countHint">Loading…</span>
        </div>

        <div class="panelBody">
          <div class="searchRow">
            <div class="searchMini">
              <input id="search" placeholder="Search subject…" oninput="onSearch()" />
              <button class="btn" onclick="onSearch()">Search</button>
            </div>
          </div>

          <div class="divider"></div>

          <div id="subjects" class="subjects" aria-live="polite"></div>
          <div id="empty" class="empty">কোনো Subject পাওয়া যায়নি।</div>

          <div style="display:flex;justify-content:center;margin-top:12px;">
            <button id="btnMore" class="btn primary" style="display:none" onclick="loadMore()">More Subject</button>
          </div>

          <div class="mtSection" aria-label="Latest model tests">
            <div class="mtTitle">
              <b>Latest Model Tests</b>
              <span class="muted" id="mtHint">Loading…</span>
            </div>
            <div id="latestMT" class="mtGrid"></div>
          </div>
        </div>
      </section>

      <aside class="sidePanel" aria-label="Sidebar ads">
        <div class="head">
          <b>Sponsored</b>
          <span>Ads</span>
        </div>
        <div class="body">
          <div class="sideAdBox">
            <div>
              <div style="font-weight:1000;color:var(--text);margin-bottom:6px;">Sidebar Ad</div>
              <div style="font-size:12px;color:var(--muted)">Paste ad code here</div>
            </div>
          </div>

          <div style="height:10px"></div>

          <div class="sideAdBox" style="min-height: 180px">
            <div>
              <div style="font-weight:1000;color:var(--text);margin-bottom:6px;">Bottom Ad</div>
              <div style="font-size:12px;color:var(--muted)">Paste ad code here</div>
            </div>
          </div>
        </div>
      </aside>
    </main>
  </div>

  <footer>
    <div class="foot">
      <div class="footLogo">
        <div class="footBrand">
          <div class="name">eProstutiBD</div>
          <div class="tag">সকল প্রস্তুতি হোক গভীর থেকে</div>
        </div>
      </div>

      <div>
        <b>দরকারি পেজ</b>
        <a href="#">About</a>
        <a href="#">Privacy Policy</a>
        <a href="#">Terms</a>
        <a href="#">Contact</a>
      </div>

      <div>
        <b>অন্যান্য</b>
        <a href="#">Notice</a>
        <a href="#">Blog</a>
        <a href="#">Career</a>
        <a href="#">Help</a>
      </div>

      <div class="footFollow">
        <b>Follow</b>
        <div class="socialRow" aria-label="Social media">
          <a href="#" aria-label="Facebook">
            <svg viewBox="0 0 24 24"><path d="M14 9h3V6h-3c-2.76 0-5 2.24-5 5v3H6v3h3v6h3v-6h3l1-3h-4v-3c0-.55.45-1 1-1Z"/></svg>
          </a>
          <a href="#" aria-label="YouTube">
            <svg viewBox="0 0 24 24"><path d="M21.6 7.2a3 3 0 0 0-2.1-2.1C17.8 4.6 12 4.6 12 4.6s-5.8 0-7.5.5A3 3 0 0 0 2.4 7.2 31 31 0 0 0 2 12a31 31 0 0 0 .4 4.8 3 3 0 0 0 2.1 2.1c1.7.5 7.5.5 7.5.5s5.8 0 7.5-.5a3 3 0 0 0 2.1-2.1A31 31 0 0 0 22 12a31 31 0 0 0-.4-4.8ZM10 15.5v-7l6 3.5-6 3.5Z"/></svg>
          </a>
          <a href="#" aria-label="Telegram">
            <svg viewBox="0 0 24 24"><path d="M21.9 5.6 19 19.2c-.2 1-.8 1.2-1.6.8l-4.4-3.2-2.1 2c-.2.2-.4.4-.8.4l.3-4.7 8.6-7.8c.4-.3-.1-.5-.6-.2l-10.6 6.7-4.6-1.4c-1-.3-1 .2-1.5L20 4.6c.9-.4 1.7.2 1.9 1Z"/></svg>
          </a>
          <a href="#" aria-label="Instagram">
            <svg viewBox="0 0 24 24"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm10 2H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3Zm-5 3.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 0 1 12 7.5Zm0 2A2.5 2.5 0 1 0 14.5 12 2.5 2.5 0 0 0 12 9.5ZM17.8 6.9a1 1 0 1 1-1 1 1 1 0 0 1 1-1Z"/></svg>
          </a>
        </div>
      </div>
    </div>

    <div class="copy">© 2026 eProstutiBD All rights reserved</div>
  </footer>

  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBUBwLuNDSJF1xrkUVTTOXs76f_o4YkBiI",
      authDomain: "eprostutibd-webapp.firebaseapp.com",
      projectId: "eprostutibd-webapp",
      storageBucket: "eprostutibd-webapp.firebasestorage.app",
      messagingSenderId: "1044069942330",
      appId: "1:1044069942330:web:b3fc6c8b75d7b80686a103",
      measurementId: "G-T2G55NMDQT"
    };

    const COL_SUBJECTS = "subjects";
    const COL_SUBJECT_MODEL_TESTS = "subject_model_tests";
    const COL_MODELTEST_QUESTIONS = "modeltest_questions";

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const $ = (id)=>document.getElementById(id);

    // ✅ menu control
    function openMenu(){
      const menu = $("mobileMenu");
      const btn = $("menuBtn");
      menu.style.display = "block";
      btn.setAttribute("aria-expanded", "true");
    }
    function closeMenu(){
      const menu = $("mobileMenu");
      const btn = $("menuBtn");
      menu.style.display = "none";
      btn.setAttribute("aria-expanded", "false");
    }
    function toggleMenu(){
      const menu = $("mobileMenu");
      if(menu.style.display === "block") closeMenu();
      else openMenu();
    }
    window.openMenu = openMenu;
    window.closeMenu = closeMenu;
    window.toggleMenu = toggleMenu;

    document.addEventListener("keydown", (e)=>{
      if(e.key === "Escape") closeMenu();
    });

    function esc(str){
      return String(str).replace(/[&<>"']/g, (m)=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;" }[m]));
    }

    function normalize(s){
      return String(s||"").toLowerCase()
        .replace(/[^\p{L}\p{N}\s]+/gu, " ")
        .replace(/\s+/g, " ")
        .trim();
    }
    function tokens(s){ const t=normalize(s); return t ? t.split(" ").filter(Boolean) : []; }
    function relatedScore(query, name){
      const q = normalize(query), n = normalize(name);
      if(!q) return 1;
      if(n.includes(q)) return 100;
      const qt = tokens(q), nt = new Set(tokens(n));
      if(!qt.length) return 1;
      let hit=0; qt.forEach(w=>{ if(nt.has(w)) hit++; });
      let partial=0;
      qt.forEach(w=>{
        if(w.length>=3){
          for(const tw of nt){ if(tw.startsWith(w) || w.startsWith(tw)){ partial += 0.35; break; } }
        }
      });
      return (hit/qt.length)*10 + partial;
    }

    let SUBJECTS = [];
    const modelTestCountMap = new Map();
    const modelTestUnsubs = new Map();

    const PAGE_SIZE = 6;
    let visibleCount = 6;
    let currentQuery = "";

    function openSubjectDetails(subjectId){
      window.open(`details-prosnobank.html?subjectId=${encodeURIComponent(subjectId)}`, "_blank", "noopener");
    }
    function openModelTestDetails(modelTestId){
      // ✅ requirement: model test card -> details-prosnobank.htm
      window.open(`details-prosnobank.htm?modelTestId=${encodeURIComponent(modelTestId)}`, "_blank", "noopener");
    }

    function syncModelTestListeners(){
      const alive = new Set(SUBJECTS.map(s=>s.id));
      for(const [sid, unsub] of modelTestUnsubs.entries()){
        if(!alive.has(sid)){
          try{ unsub(); }catch(e){}
          modelTestUnsubs.delete(sid);
          modelTestCountMap.delete(sid);
        }
      }
      SUBJECTS.forEach(s=>{
        if(modelTestUnsubs.has(s.id)) return;
        const unsub = db.collection(COL_SUBJECT_MODEL_TESTS)
          .where("subjectId","==", s.id)
          .onSnapshot((snap)=>{
            modelTestCountMap.set(s.id, snap.size || 0);
            renderSubjects();
          }, (err)=>{
            console.error(err);
            modelTestCountMap.set(s.id, modelTestCountMap.get(s.id) || 0);
          });
        modelTestUnsubs.set(s.id, unsub);
      });
    }

    function renderSkeleton(){
      const wrap = $("subjects");
      wrap.innerHTML = "";
      for(let i=0;i<6;i++){
        const d = document.createElement("div");
        d.className = "skeleton";
        d.innerHTML = `<div class="shimmer"></div>`;
        wrap.appendChild(d);
      }
      $("empty").style.display = "none";
      $("btnMore").style.display = "none";
    }

    function makeInlineAdCard(){
      const ad = document.createElement("div");
      ad.className = "inlineAd";
      ad.innerHTML = `
        <div>
          <div class="tag">Ad Slot</div>
          <div style="font-size:12px;">এখানে AdSense/Adstra কোড বসবে</div>
        </div>
      `;
      return ad;
    }

    function renderSubjects(){
      const q = currentQuery;
      const scored = SUBJECTS
        .map(s => ({...s, __score: relatedScore(q, s.name || "")}))
        .filter(s => !q ? true : (s.__score >= 1.2))
        .sort((a,b)=>{
          if(b.__score !== a.__score) return b.__score - a.__score;
          return (a.name||"").localeCompare(b.name||"");
        });

      const total = scored.length;
      const shown = scored.slice(0, visibleCount);
      $("countHint").textContent = `Total: ${total}`;

      const wrap = $("subjects");
      wrap.innerHTML = "";

      if(!total){
        $("empty").style.display = "block";
        $("btnMore").style.display = "none";
        return;
      }
      $("empty").style.display = "none";

      let cardCount = 0;
      shown.forEach((s, idx)=>{
        cardCount++;
        const mcq = s.counts?.mcq || 0;
        const written = s.counts?.written || 0;
        const mtCount = modelTestCountMap.get(s.id) ?? 0;

        const el = document.createElement("article");
        el.className = "subCard";
        el.setAttribute("role","button");
        el.setAttribute("tabindex","0");
        el.onclick = ()=>openSubjectDetails(s.id);
        el.onkeydown = (e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); openSubjectDetails(s.id);} };

        el.innerHTML = `
          <h3 title="${esc(s.name||"")}">${esc(s.name||"(no name)")}</h3>
          <div class="counts">
            <span class="countPill">MCQ <b>${mcq}</b></span>
            <span class="countPill">Written <b>${written}</b></span>
            <span class="countPill">Model test <b>${mtCount}</b></span>
          </div>
        `;
        wrap.appendChild(el);

        if(cardCount % 6 === 0 && idx < shown.length - 1){
          wrap.appendChild(makeInlineAdCard());
        }
      });

      $("btnMore").style.display = (total > shown.length) ? "inline-flex" : "none";
    }

    function onSearch(){
      currentQuery = ($("search").value || "").trim();
      visibleCount = PAGE_SIZE;
      renderSubjects();
    }
    window.onSearch = onSearch;

    function loadMore(){
      visibleCount += PAGE_SIZE;
      renderSubjects();
    }
    window.loadMore = loadMore;

    const qCountUnsubs = new Map();
    const qCountMap = new Map();
    let latestMTDocsCache = [];

    function formatTimeMin(v){
      if(v === undefined || v === null || v === "") return "-";
      if(typeof v === "number") return `${v} min`;
      if(typeof v === "string"){
        const t=v.trim(); if(!t) return "-";
        const n=Number(t);
        if(!Number.isNaN(n) && t.match(/^\d+(\.\d+)?$/)) return `${n} min`;
        return t;
      }
      try{ return JSON.stringify(v); }catch(e){ return String(v); }
    }

    function getTimeField(data){
      const keys = ["totalTimeMin","totalTime","total_time","duration","time","minutes"];
      for(const k of keys){
        if(data && data[k] !== undefined && data[k] !== null && data[k] !== "") return data[k];
      }
      return "-";
    }
    function getMarkField(data){
      const keys = ["totalMarks","totalMark","total_mark","mark","marks"];
      for(const k of keys){
        if(data && data[k] !== undefined && data[k] !== null && data[k] !== "") return data[k];
      }
      return "-";
    }
    function getTitleField(data){
      return data?.title ?? data?.name ?? "Subject Model Test";
    }
    function getPreQCount(data){
      const keys = ["totalQuestions","total_questions","totalQ","questionCount","questionsCount"];
      for(const k of keys){
        if(data && data[k] !== undefined && data[k] !== null && data[k] !== "") return data[k];
      }
      return null;
    }

    function ensureQuestionCountListener(mtId){
      if(qCountUnsubs.has(mtId)) return;
      const unsub = db.collection(COL_MODELTEST_QUESTIONS)
        .where("modelTestId","==", mtId)
        .onSnapshot((snap)=>{
          qCountMap.set(mtId, snap.size || 0);
          renderLatestModelTests(latestMTDocsCache);
        }, (err)=>{
          console.error(err);
          qCountMap.set(mtId, 0);
          renderLatestModelTests(latestMTDocsCache);
        });
      qCountUnsubs.set(mtId, unsub);
    }
    function cleanupQuestionCountListeners(activeIds){
      for(const [id, unsub] of qCountUnsubs.entries()){
        if(!activeIds.has(id)){
          try{ unsub(); }catch(e){}
          qCountUnsubs.delete(id);
          qCountMap.delete(id);
        }
      }
    }

    function renderLatestModelTests(docs){
      const wrap = $("latestMT");
      latestMTDocsCache = docs;
      wrap.innerHTML = "";

      if(!docs.length){
        $("mtHint").textContent = "0";
        wrap.innerHTML = `<div style="grid-column:1/-1;color:var(--muted);font-size:12px;">কোনো Model Test পাওয়া যায়নি।</div>`;
        return;
      }
      $("mtHint").textContent = `${docs.length}`;

      const active = new Set(docs.map(d=>d.id));
      cleanupQuestionCountListeners(active);

      docs.forEach(d=>{
        const data = d.data() || {};
        const title = getTitleField(data);
        const timeVal = formatTimeMin(getTimeField(data));
        const markVal = getMarkField(data);

        const preQ = getPreQCount(data);
        if(preQ == null) ensureQuestionCountListener(d.id);
        const qCount = (preQ != null) ? preQ : (qCountMap.get(d.id) ?? 0);

        const card = document.createElement("div");
        card.className = "mtCard";
        card.setAttribute("role","button");
        card.setAttribute("tabindex","0");
        card.onclick = ()=>openModelTestDetails(d.id);
        card.onkeydown = (e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); openModelTestDetails(d.id);} };

        card.innerHTML = `
          <h4 title="${esc(title)}">${esc(title)}</h4>
          <div class="mtMeta">
            <span>Time: ${esc(timeVal)}</span>
            <span>Mark: ${esc(markVal)}</span>
            <span>Q: ${esc(qCount)}</span>
          </div>
        `;
        wrap.appendChild(card);
      });
    }

    function watchLatestModelTests(){
      $("mtHint").textContent = "Loading…";
      const LIMIT = 8;

      db.collection(COL_SUBJECT_MODEL_TESTS)
        .orderBy("createdAt", "desc")
        .limit(LIMIT)
        .onSnapshot((snap)=>renderLatestModelTests(snap.docs), (err)=>{
          console.warn("createdAt order failed, fallback:", err);
          db.collection(COL_SUBJECT_MODEL_TESTS)
            .limit(LIMIT)
            .onSnapshot((s2)=>renderLatestModelTests(s2.docs), (e2)=>{
              console.error(e2);
              $("mtHint").textContent = "Failed";
            });
        });
    }

    renderSkeleton();
    watchLatestModelTests();

    db.collection(COL_SUBJECTS).onSnapshot((snap)=>{
      SUBJECTS = snap.docs.map(d => ({ id:d.id, ...d.data() }));
      syncModelTestListeners();
      renderSubjects();
    }, (err)=>{
      console.error(err);
      $("countHint").textContent = "Failed to load";
      $("subjects").innerHTML = "";
      $("empty").style.display = "block";
      $("btnMore").style.display = "none";
    });
  </script>
</body>
</html>
